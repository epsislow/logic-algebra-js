<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bit Language Interpreter for LogTScript v0.3.1</title>
<style>
body { font-family: monospace; background:#111; color:#eee; padding:20px }
textarea { width:100%; height:340px; background:#000; color:#0f0 }
textarea {
  white-space: pre;       /* Keeps text on one line and preserves spaces */
  overflow-wrap: normal;  /* Prevents breaking words in the middle */
  overflow-x: auto;       /* Adds a horizontal scrollbar only when needed */
}
button { margin:4px; padding:5px 9px; cursor: pointer; }
pre { background:#000; padding:10px; max-height:260px; overflow:auto }
.panel { border:1px solid #444; padding:10px; margin-top:10px }
.flex { display:flex; gap:10px }
.filename { font-size: 20px;}
.dirpath { font-size: 15px; color: #88f}
.filelist { border: 1px solid #3D4; width:90%; padding: 3px; margin: 5px; }
.filelist .file { padding: 4px; color: mediumaquamarine; cursor: pointer;}
.filelist .dir { padding: 4px; color: yellowgreen;  cursor: pointer; }
.filelist .file:hover { color: cyan; }
.filelist .dir:hover { color: yellow; }
// button.cls { background-color: #7a7; }
// button.cls:hover { background-color: #afa; }
.hidden { display: none;}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;

  height: 30px;
  min-width: 20px;
  padding: 0 10px;
  margin: 6px 2px;

  font-size: 13px;
  line-height: 1;
  font-weight: 500;

  color: #eaeaea;
  background: #1c1c1c;

  border: 1px solid #2a2a2a;
  border-radius: 999px; /* pill shape */

  cursor: pointer;
  vertical-align: middle;

  transition:
    background-color 0.15s ease,
    border-color 0.15s ease,
    transform 0.05s ease;
}

.btn:hover {
  background: #242424;
  border-color: #3a3a3a;
}

.btn:active {
  transform: translateY(1px);
  background: #2a2a2a;
}

.btn--primary {
  background: linear-gradient(180deg, #2f80ff, #1f66e0);
  border-color: #2f80ff;
  color: #fff;
}

.btn[disabled="1"] {
  color: #333;
}

.btn--primary:hover {
  background: linear-gradient(180deg, #3a8cff, #2a72eb);
}

#confirm .btn.c {
  background-color: brown;
  color: #ffa;
}

#confirm .btn.c:hover {
  background-color: chocolate;
}

#devices {
  display: flex;
  flex-wrap: wrap;
}

#devices .break {
  flex-basis: 100%;
}

/*
.led-3d {
  width: 25px;
  height: 25px;
  border-radius: 50%;
   Gradient simulates light hidden behind plastic 
  background-image: radial-gradient(circle at 30% 30%, #ff9999, #ff0000 60%, #800000 100%);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3), 0 0 15px #ff0000;
}*/

.led-red-glow {
  width: 20px;
  height: 20px;
  background-color: #ff4d4d; /* Slightly lighter red for the core */
  border-radius: 50%;
  /* Stacking shadows for realistic glow */
  box-shadow: 
    inset 0 0 5px #fff,      /* Inner highlight */
    0 0 5px #ff0000,         /* Close glow */
    0 0 15px #ff0000,        /* Medium glow */
    0 0 30px #ff0000;        /* Outer atmospheric glow */
}

/*
.led-red-glow2 {
  width: 20px;
  height: 20px;
  border-radius: 50%;
   Define the 'on' state animation 
  animation: led-blink 2s infinite;
}

@keyframes led-blink {
  0%, 100% {
    background-color: #400000;
    box-shadow: none;
  }
  50% {
    background-color: #ff0000;
    box-shadow: 0 0 15px #ff0000, 0 0 30px #ff0000;
  }
}*/


/* LED wrapper (optional label support) */
.led-wrapper {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  margin: 5px 0;
}

/* Label (same rules as switch) */
.led-label {
  font-family: monospace;
  font-size: 0.85rem;
  width: 5ch;
  text-align: right;
  color: #bdbdbd;
}
.led-no-label {
  font-family: monospace;
  font-size: 0.85rem;
  width: 1px;
  text-align: right;
  color: transparent;
}

/* Hidden checkbox (logic only) */
.led-input {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

/* LED core */
.led {
 display: inline-block; 
  width: 14px;
  height: 14px;
  border-radius: var(--led-radius, 50%);
  background-color: #222;
  box-shadow: inset 1px 1px 2px #333;
  /*margin: 0 0px -2px 0px;*/
}

/* ON state using CSS variable */
.led-input:checked + .led {
  background-color: var(--led-color, #ff0000);
  box-shadow:
    inset 0 0 4px #fff,
    0 0 2px var(--led-color, #ff0000),
    0 0 4px var(--led-color, #ff0000),
    0 0 8px var(--led-color, #ff0000);
}


/* Wrapper */
.switch-wrapper {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  user-select: none;
  margin: 5px 0;
}

.switch-wrapper:active .switch {
  transform: scale(0.96);
}

/* Label */
.switch-label {
  font-family: monospace;
  font-size: 0.85rem;
  width: 5ch;
  text-align: right;
  color: #bdbdbd; /* soft gray for dark bg */
}

/* Hide checkbox but keep accessible */
.switch-input {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

/* Switch track */
.switch {
  position: relative;
  width: 36px;
  height: 18px;
  background-color: #2a2a2a;
  border-radius: 999px;
  box-shadow: inset 0 0 0 1px #3a3a3a;
  transition: background-color 0.2s ease,
       box-shadow 0.2s ease,
       transform 0.05s ease;
  
}

/* Knob */
.switch::before {
  content: "";
  position: absolute;
  top: 2px;
  left: 2px;
  width: 14px;
  height: 14px;
  background: #e0e0e0;
  border-radius: 50%;
  transition: transform 0.2s ease, background-color 0.2s ease;
}

/* ON state */
.switch-input:checked + .switch {
  background-color: #1f6f3f; /* deep green */
  box-shadow:
    inset 0 0 0 1px #2ecc71,
    0 0 6px rgba(46, 204, 113, 0.6);
}

.switch-input:checked + .switch::before {
  transform: translateX(18px);
  background-color: #dfffe9;
}

/* Focus (keyboard navigation) */
.switch-input:focus-visible + .switch {
  outline: 2px solid #2ecc71;
  outline-offset: 2px;
}



/* ===== Wrapper ===== */

.sevenseg {
  --seg-scale:.75;
}

.sevenseg-wrapper {
  display: inline-flex;
  align-items: flex-start;
  gap: 0.1rem;
  min-height: calc(1em + 2px);
  padding-bottom: 5px;
}

.sevenseg-dot {
  display: flex;
  align-items: flex-end;
  padding-bottom: 6px; /* aligns dot with seg D */
}

.sevenseg-time-dot-up {
  display: flex;
  align-items: flex-end;
  padding-bottom: 6px;
}

.sevenseg-label {
  font-family: monospace;
  font-size: 0.85rem;
  width: 5ch;
  text-align: right;
  color: #bdbdbd;
}

.sevenseg-no-label {
  font-family: monospace;
  font-size: 0.85rem;
  width: 1px;
  text-align: right;
  color: transparent;
}

/* ===== 7-segment grid (tracks, NOT segments) ===== 
.sevenseg {
  display: grid;
  grid-template-columns: 28px 10px 28px;
  grid-template-rows:
    12px    A track 
    30px    F / B track 
    12px    G track 
    30px    E / C track 
    6px     spacer 
    12px;   D track 
  gap: 0;
}*/

.sevenseg {
  display: grid;
  grid-template-columns:
    calc(26px * var(--seg-scale))
    calc(8px  * var(--seg-scale))
    calc(26px * var(--seg-scale));
  grid-template-rows:
    calc(10px * var(--seg-scale)) /* A */
    calc(26px * var(--seg-scale)) /* F / B */
    calc(10px * var(--seg-scale)) /* G */
    calc(26px * var(--seg-scale)) /* E / C */
    calc(2px  * var(--seg-scale)) /* spacer */
    calc(10px * var(--seg-scale));/* D */
  gap: 0;
  position: relative;
  overflow: visible; /* ← THIS IS REQUIRED */
}

/* ===== Hidden checkbox (logic only) ===== */
.seg-input {
  position: absolute;
  width: 0;
  height: 0;
  opacity: 0;
  pointer-events: none;
}

/* ===== Segment base ===== */
.segment {
  background-color: #1a1a1a;
  border-radius: 999px;
  box-shadow: inset 1px 1px 0px #777;
  cursor: pointer;
  filter: blur(0.2px); /* light diffusion */
  opacity: 0.35;       /* dim when off */
}

.sevenseg-dot {
  position: absolute;
  right: 0px;
  bottom: -6px;
  z-index: 2; /* ← IMPORTANT */
/*  outline: 1px solid red;*/
}

.sevenseg-time-dot-up {
  position: absolute;
  right: -4px;
  bottom: 10px;
  z-index: 3;
}

.sevenseg-time-dot-down {
  position: absolute;
  right: -4px;
  bottom: 20px;
  z-index: 3;
}

/* ===== Horizontal segments (shorter than track) ===== */
.seg-a,
.seg-g,
.seg-d {
  width: calc(24px * var(--seg-scale));
  height: calc(8px * var(--seg-scale));
  justify-self: center;
  align-self: center;
}

/* ===== Vertical segments (shorter than track) ===== */
.seg-b,
.seg-c,
.seg-e,
.seg-f {
  width:  calc(8px  * var(--seg-scale));
  height: calc(24px * var(--seg-scale));
  justify-self: center;
  align-self: center;
}

.seg-h {
  width:  calc(8px * var(--seg-scale));
  height: calc(8px * var(--seg-scale));
  border-radius: 50%;
  background-color: #1a1a1a;
  box-shadow: inset 1px 1px 0px #777;
  opacity: 0.35;
  filter: blur(0.2px);
  cursor: pointer;
}

.seg-i,
.seg-j {
  width:  calc(9px * var(--seg-scale));
  height: calc(14px * var(--seg-scale));
  border-radius: 99px;
  background-color: #1a1a1a;
  box-shadow: inset 1px 1px 0px #777;
  opacity: 0.35;
  filter: blur(0.2px);
  cursor: pointer;
}

/* ===== Segment positioning ===== */
.seg-a { grid-column: 1 / 4; grid-row: 1; }
.seg-f { grid-column: 1;     grid-row: 2; }
.seg-b { grid-column: 3;     grid-row: 2; }
.seg-g { grid-column: 1 / 4; grid-row: 3; }
.seg-e { grid-column: 1;     grid-row: 4; }
.seg-c { grid-column: 3;     grid-row: 4; }
.seg-d { grid-column: 1 / 4; grid-row: 6; }

/* ===== ON state (realistic glow) ===== */
.seg-input:checked + .segment {
  opacity: 1;
  background-color: var(--seg-color, #6dff9c);
  box-shadow:
    inset 0 0 calc(6px * var(--seg-scale)) rgba(255,255,255,0.6),
    0 0 calc(8px * var(--seg-scale)) var(--seg-color),
    0 0 calc(18px * var(--seg-scale)) var(--seg-color),
    0 0 calc(36px * var(--seg-scale)) rgba(109,255,156,0.6);
}


.seg-input:checked + .seg-h {
  opacity: 1;
  background-color: var(--seg-color, #6dff9c);
  box-shadow:
    inset 0 0 calc(4px * var(--seg-scale)) rgba(255,255,255,0.6),
    0 0 calc(6px * var(--seg-scale)) var(--seg-color),
    0 0 calc(14px * var(--seg-scale)) var(--seg-color),
    0 0 calc(24px * var(--seg-scale)) rgba(109,255,156,0.6);
}



/* =========================
   DIP SWITCH WRAPPER
========================= */

.dip-wrapper {
  display: inline-flex;
  align-items: flex-start;
  gap: 0.6rem;
}

/* Label (same style as others) */
.dip-label {
  font-family: monospace;
  font-size: 0.85rem;
  width: 5ch;
  text-align: right;
  color: #bdbdbd;
}

/* =========================
   DIP BODY
========================= */

.dip {
  display: flex;
  gap: 6px;
  padding: 6px;
  background: #1a1a1a;
  flex-direction: column;
  border-radius: 6px;
  box-shadow: inset 0 0 0 1px #2a2a2a;
  margin-bottom: 5px;
}

/* =========================
   SINGLE DIP SWITCH
========================= */

.dip-unit {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  font-family: monospace;
  font-size: 0.65rem;
  color: #aaa;
}

/* Hidden checkbox */
.dip-input {
  position: absolute;
  width: 0;
  height: 0;
  margin: 0;
  padding: 0;
  opacity: 0;
  pointer-events: none;
}


/* Switch track */
.dip-switch {
  position: relative;
  width: 18px;
  height: 36px;
  background: #2a2a2a;
  border-radius: 999px;
  box-shadow: inset 0 0 3px #000;
  cursor: pointer;
}

/* Knob */
.dip-switch::before {
  content: "";
  position: absolute;
  left: 2px;
  bottom: 2px;
  width: 14px;
  height: 14px;
  background: #ccc;
  border-radius: 999px;
  transition: transform 0.15s ease, background-color 0.15s ease;
}

/* ON (UP) */
.dip-input:checked + .dip-switch {
  background: #1f6f3f;
  box-shadow:
    inset 0 0 0 1px #2ecc71,
    0 0 6px rgba(46, 204, 113, 0.6);
}

.dip-input:checked + .dip-switch::before {
  transform: translateY(-18px);
  background: #dfffe9;
}



/* =========================
   DIP VISUAL 1 (BUTTON STYLE)
========================= */

.dip-visual-1 .dip-switch {
  width: 16px;
  height: 16px;
  border-radius: 5px;
  background: #0e0e0e;
  border: 1px solid #333;
  box-shadow: inset 0 0 4px #000;
  transition:
    background-color 0.2s ease,
    box-shadow 0.2s ease,
    transform 0.1s ease;
}

/* hide slider knob */
.dip-visual-1 .dip-switch::before {
  display: none;
}

.dip-no-labels .dip-unit > span:first-child {
  display: none;
}

/* ON state */
.dip-visual-1 .dip-input:checked + .dip-switch {
  background: #1f6f3f;
  border-color: #2ecc71;
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.2),
    0 0 10px rgba(46,204,113,0.6);
}

/* pressed feedback */
.dip-visual-1 .dip-switch:active {
  transform: scale(0.92);
}

/* =========================
   DIP ROWS
========================= */

.dip-row {
  display: flex;
  gap: 6px;
}

/* space between rows
.dip-row + .dip-row {
  margin-top: 6px;
} */

/* =========================
   CHARACTER LCD WRAPPER
========================= */

.lcd-wrapper {
  display: inline-flex;
  align-items: flex-start;
  margin: 4px;
  padding: 6px 6px;              
  background: #111;
  border-radius: 8px;
  box-shadow:
    inset 0 0 0 1px #2a2a2a,
    0 0 12px rgba(0,0,0,0.6);
}
.lcd-wrapper canvas { display: block; }

/* =========================
   KEY WRAPPER
========================= */

.key-wrapper {
  display: inline-block;
  margin-right: 6px;
  margin-bottom: 6px;
  vertical-align: top;
}

.key-wrapper canvas {
  display: block; /* avoid baseline issues */
}

/* =========================
   ROTARY KNOB WRAPPER
========================= */

.knob-wrapper {
  display: inline-flex;
  align-items: center;
  gap: 0.6rem;
  margin-right: 1rem;
}

.knob-label {
  font-family: monospace;
  font-size: 0.85rem;
  width: 5ch;
  text-align: right;
  color: #bdbdbd;
}

.knob-wrapper canvas {
  display: block; /* avoid baseline issues */
}

.knob-value {
  font-family: monospace;
  font-size: 0.75rem;
  color: #6dff9c;
  min-width: 3ch;
}



/*==== dropdown panels ==== */

.panel-dropdown {
  position: relative;
  display: inline-block;
  z-index: 1000;
}

/* Dropdown menu */
.dropdown-menu {
  position: absolute;
  top: calc(100% + 6px);
  left: 0;

  min-width: 160px;
  padding: 6px;

  background: #1c1c1c;
  border: 1px solid #2a2a2a;
  border-radius: 12px;

  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);

  display: none;
  z-index: 100;
}

.panel-dropdown.open .dropdown-menu {
  display: block;
}

/* Dropdown items */
.dropdown-item {
  display: flex;
  align-items: center;

  height: 30px;
  padding: 0 12px;
  width: 100%;

  font-size: 13px;
  color: #eaeaea;
  background: transparent;

  border: none;
  border-radius: 999px;

  cursor: pointer;
  text-align: left;

  transition:
    background-color 0.15s ease,
    color 0.15s ease;
}

.dropdown-item:hover {
  background: #242424;
}

/* Active / toggled-on state */
.dropdown-item.active {
  background: #2a2a2a;
  color: #ffffff;
}

.dropdown-item.active::after {
  content: "✓";
  margin-left: auto;
  opacity: 0.8;
}



</style>
</head>
<body>
<script type="text/javascript">
  /*window.onerror = function(message, source, lineno) {
    alert("Error: " + message + "\nLine: " + lineno);
    return true;
  };*/
  
</script>
<!--script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script-->

<script type="text/javascript" src="lz-string-min.js"></script>

<h2>Bit Language Interpreter for LogTScript v0.3.1</h2>

<textarea id="code" 
   spellcheck="false" 
   autocorrect="off" 
   autocomplete="off" 
   autocapitalize="off"
>
MODE WIREWRITE

2wire b
2wire a = REG2(b, ~, 0)
2wire c = REG2(a, ~, 0)
#b= NOT(a.0) + NOT(a.1)
b= a
show(a,b,c)
NEXT(~)
NEXT(~)
show(a,b,c)
NEXT(~)
NEXT(~)
show(a,b,c)
NEXT(~)
NEXT(~)
show(a,b,c)
NEXT(~)
NEXT(~)
show(a,b,c)

# Basic wire test
#1bit a = 0
#1wire b = a
#show(a)
#show(b)
#show(&a)
#show(&b)

# NEXT test
#1wire bb
#bb = XOR(~, bb)
#show(~)
#show(bb)
#NEXT(~)
#show(bb)
#show(&~)
</textarea>
<div id="fName">Filename:<span id="fileName"></span></div>
<div>
  <button onclick="run()" class="btn">Run</button>
  <!--button onclick="toggleCmd()">Cmd</button-->
  <button onclick="doNext(1)" class="btn">Next</button>
  <button onclick="toggleSEC()" id="sec" class="btn">S</button>
  <button onclick="changeSECINT()" id="secint" class="btn">1</button>
  <!--button onclick="toggleFiles()" class="btn">Files</button>
  <button onclick="toggleDevices()" class="btn">Dvi</button-->
  
    <div class="panel-dropdown">
      <button class="btn dropdown-trigger" aria-expanded="false">
        Win ▾
      </button>

      <div class="dropdown-menu">
        <button class="dropdown-item active" data-panel="output">Output</button>
        <button class="dropdown-item active" data-panel="variables">Variables</button>
        <button class="dropdown-item" data-panel="files">Files</button>
        <button class="dropdown-item" data-panel="devices">Devices</button>
        <button class="dropdown-item" data-panel="ast">AST</button>
        <button class="dropdown-item" data-panel="command">Command</button>
      </div>
    </div>  
  <button class="btn" onclick="addTab()">+Tb</button>
  <button class="btn" onclick="closeTab()">-Tb</button>
  
</div>

<div id="cmdPanel" style="display:none; margin:10px 0;">
  <div style="display:flex; align-items:center; gap:10px;">
    <textarea id="cmdInput" style="flex:1; min-height:60px; font-family:monospace; background:#222; color:#eee; border:1px solid #444; padding:8px;" placeholder="Enter commands here..."></textarea>
    <button onclick="sendCmd()" style="padding:8px 16px;">Send</button>
  </div>
</div>

<div class="flex">
  <div class="panel" id="outputPanel" style="flex:1">
    <h3>Output</h3>
    <pre id="out"></pre>
  </div>

  <div class="panel" id="variablesPanel" style="flex:1">
    <h3>Variables</h3>
    <pre id="vars"></pre>
  </div>
</div>

<div class="panel" id="astPanel" style="display:none">
  <h3>AST</h3>
  <pre id="ast"></pre>
</div>

<div class="panel" id="devicesPanel" style="display:none">
  <h3>Devices</h3>
  <div id="devices">
  </div>
</div>

<div class="panel" id="filesPanel" style="display:none">
  <h3>Files</h3>
  <button id="direxit" onclick="btndirExit()" class="btn" disabled=1>&lt;</button>
  <button id="direnter" onclick="btndirEnter()" class="btn" disabled=1>&gt;</button>
  <button onclick="btnClr()" class="btn cls">Cls</button>
  <button id="fileload" onclick="btnfileLoad()" class="btn" disabled=1>load</button>
  <button id="filedirdelete" onclick="btnfiledirDelete()" class="btn" disabled=1>-del</button>
  <button id="dirsave" onclick="btnfileSave(1)" class="btn" disabled=1>+dir </button>
  <button id="fileupdate" onclick="btnfileUpdate()" class="btn" disabled=1>Upd</button>
  <button id="resetlib" onclick="btnresetLib()" class="btn">-lib</button>
  <div class="confirm" id="confirm" style="display:none">
    <span>Sure?</span>
    <button id="yes" onclick="yes()" class="c btn">yes</button>
    <button id="no" onclick="no()" class="c btn">no</button>
  </div>
  <br/>
  <input id="filename" placeholder="name" class="filename"/>
  <button id="filesave" onclick="btnfileSave(0)" disabled=1>save</button>
  <div id="dirpath" class="dirpath"></div>
  <div id="filelist" class="filelist"></div>
</div>


<script type="text/javascript" src="lib/main.js"></script>

</body>
</html>
</html>
